<UserControl x:Class="QuanLyDuLich.GUI.GuideForm.GuideForm"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="1000">
    <Grid Background="#F5F6FA">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- HEADER DASHBOARD -->
        <Border Background="White" Padding="20,15" BorderBrush="#E0E0E0" BorderThickness="0,0,0,1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Thông tin xin chào -->
                <StackPanel Orientation="Horizontal" Grid.Column="0" VerticalAlignment="Center">
                    <TextBlock Text="👋 Xin chào, " FontSize="20" Foreground="#2C3E50"/>
                    <TextBlock x:Name="lblGuideName" Text="[Tên HDV]" FontSize="20" FontWeight="Bold" Foreground="#2980B9"/>
                    <Border Background="#EBF5FB" CornerRadius="10" Padding="10,2" Margin="10,0,0,0" VerticalAlignment="Center">
                        <TextBlock Text="Hướng Dẫn Viên" FontSize="12" Foreground="#2980B9" FontWeight="SemiBold"/>
                    </Border>
                </StackPanel>

                <!-- Nút Đăng Xuất -->
                <Button Grid.Column="1" Content="🚪 Đăng xuất" Click="BtnLogout_Click"
                        Background="Transparent" Foreground="#E74C3C" BorderThickness="0" 
                        FontSize="14" Cursor="Hand" Padding="10,5">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border Background="{TemplateBinding Background}" CornerRadius="5" BorderBrush="#E74C3C" BorderThickness="1">
                                <ContentPresenter VerticalAlignment="Center" HorizontalAlignment="Center" Margin="{TemplateBinding Padding}"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#E74C3C"/>
                                    <Setter Property="Foreground" Value="White"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Button.Template>
                </Button>
            </Grid>
        </Border>

        <!-- MAIN CONTENT TABS -->
        <TabControl Grid.Row="1" Margin="20" BorderThickness="0" Background="Transparent">
            <TabControl.Resources>
                <Style TargetType="TabItem">
                    <Setter Property="FontSize" Value="16"/>
                    <Setter Property="Padding" Value="20,10"/>
                    <Setter Property="FontWeight" Value="SemiBold"/>
                    <Setter Property="Cursor" Value="Hand"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="TabItem">
                                <Grid>
                                    <Border x:Name="Bd" BorderBrush="Transparent" BorderThickness="0,0,0,3" Background="Transparent" Padding="{TemplateBinding Padding}">
                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" ContentSource="Header"/>
                                    </Border>
                                </Grid>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter TargetName="Bd" Property="BorderBrush" Value="#2980B9"/>
                                        <Setter Property="Foreground" Value="#2980B9"/>
                                    </Trigger>
                                    <Trigger Property="IsSelected" Value="False">
                                        <Setter Property="Foreground" Value="#7F8C8D"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </TabControl.Resources>

            <!-- TAB 1: LỊCH TRÌNH CỦA TÔI -->
            <TabItem Header="📅 Lịch Trình Của Tôi">
                <Grid Background="White" Margin="0,15,0,0">
                    <Grid.Effect>
                        <DropShadowEffect BlurRadius="10" Opacity="0.1" ShadowDepth="2"/>
                    </Grid.Effect>

                    <DataGrid x:Name="dgMySchedules" AutoGenerateColumns="False" IsReadOnly="True"
                              Margin="0" BorderThickness="0"
                              SelectionMode="Single" HeadersVisibility="Column"
                              GridLinesVisibility="Horizontal" Background="White" RowHeaderWidth="0">
                        <DataGrid.Resources>
                            <Style TargetType="DataGridColumnHeader">
                                <Setter Property="Padding" Value="15,12"/>
                                <Setter Property="Background" Value="#F8F9FA"/>
                                <Setter Property="FontWeight" Value="Bold"/>
                                <Setter Property="Foreground" Value="#34495E"/>
                            </Style>
                            <Style TargetType="DataGridCell">
                                <Setter Property="Padding" Value="15,10"/>
                            </Style>
                        </DataGrid.Resources>
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Tên Tour" Binding="{Binding Tour.TourName}" Width="2*"/>
                            <DataGridTextColumn Header="Ngày Đi" Binding="{Binding DeDate, StringFormat=dd/MM/yyyy}" Width="150"/>
                            <DataGridTextColumn Header="Ngày Về" Binding="{Binding ReDate, StringFormat=dd/MM/yyyy}" Width="150"/>
                            <DataGridTextColumn Header="Số Khách" Binding="{Binding Booked}" Width="100"/>

                            <DataGridTemplateColumn Header="Trạng Thái" Width="150">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Border CornerRadius="15" Padding="10,4">
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Setter Property="Background" Value="#E8F8F5"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding IsCancel}" Value="True">
                                                            <Setter Property="Background" Value="#FDEDEC"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>
                                            <TextBlock HorizontalAlignment="Center" FontWeight="SemiBold">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="Text" Value="Sắp khởi hành"/>
                                                        <Setter Property="Foreground" Value="#16A085"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding IsCancel}" Value="True">
                                                                <Setter Property="Text" Value="Đã Hủy"/>
                                                                <Setter Property="Foreground" Value="#E74C3C"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <!-- [MỚI] Cột Thao tác xem hành khách -->
                            <DataGridTemplateColumn Header="Thao Tác" Width="140">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Content="👥 Xem Khách" Click="BtnViewPassengers_Click"
                                                Background="#3498DB" Foreground="White" BorderThickness="0"
                                                Padding="10,5" Cursor="Hand" FontWeight="SemiBold"
                                                ToolTip="Xem danh sách hành khách đi tour này"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- TAB 2: HỒ SƠ CÁ NHÂN -->
            <TabItem Header="👤 Hồ Sơ &amp; Tài Khoản">
                <Grid Background="White" Margin="0,15,0,0">
                    <Grid.Effect>
                        <DropShadowEffect BlurRadius="10" Opacity="0.1" ShadowDepth="2"/>
                    </Grid.Effect>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Thông tin cá nhân -->
                    <StackPanel Grid.Column="0" Margin="40">
                        <TextBlock Text="THÔNG TIN CƠ BẢN" FontSize="18" FontWeight="Bold" Foreground="#34495E" Margin="0,0,0,20"/>

                        <Label Content="Họ và Tên:" Foreground="Gray"/>
                        <TextBox x:Name="txtFullName" Padding="10" Margin="0,0,0,15" BorderBrush="#BDC3C7"/>

                        <Label Content="Số điện thoại:" Foreground="Gray"/>
                        <TextBox x:Name="txtPhone" Padding="10" Margin="0,0,0,15" BorderBrush="#BDC3C7"/>

                        <Label Content="Ngôn ngữ:" Foreground="Gray"/>
                        <TextBox x:Name="txtLanguage" Padding="10" Margin="0,0,0,15" BorderBrush="#BDC3C7"/>

                        <Label Content="Kinh nghiệm (năm):" Foreground="Gray"/>
                        <TextBox x:Name="txtExp" Padding="10" Margin="0,0,0,15" BorderBrush="#BDC3C7"/>
                    </StackPanel>

                    <!-- Đổi mật khẩu -->
                    <StackPanel Grid.Column="1" Margin="40" Background="#FAFAFA">
                        <StackPanel Margin="20">
                            <TextBlock Text="BẢO MẬT TÀI KHOẢN" FontSize="18" FontWeight="Bold" Foreground="#C0392B" Margin="0,0,0,20"/>

                            <Label Content="Tên đăng nhập (ID):" Foreground="Gray"/>
                            <TextBox x:Name="txtUsername" IsReadOnly="True" Background="#EEEEEE" Padding="10" Margin="0,0,0,15" BorderBrush="#BDC3C7" FontWeight="Bold"/>

                            <Label Content="Mật khẩu mới:" Foreground="Gray"/>
                            <PasswordBox x:Name="pbPassword" Padding="10" Margin="0,0,0,15" BorderBrush="#BDC3C7"/>

                            <Label Content="Nhập lại mật khẩu:" Foreground="Gray"/>
                            <PasswordBox x:Name="pbConfirmPassword" Padding="10" Margin="0,0,0,25" BorderBrush="#BDC3C7"/>

                            <Button Content="LƯU THAY ĐỔI" Click="BtnSaveProfile_Click"
                                    Background="#2980B9" Foreground="White" FontWeight="Bold" FontSize="14"
                                    Padding="15" BorderThickness="0" Cursor="Hand">
                                <Button.Effect>
                                    <DropShadowEffect BlurRadius="5" Opacity="0.2" ShadowDepth="2"/>
                                </Button.Effect>
                            </Button>
                        </StackPanel>
                    </StackPanel>
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</UserControl>